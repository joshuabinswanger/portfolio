---
import SquareBracketH from "./SquareBracket_H.astro";
import "../styles/global.css";
import ImageElement from "./ImageElement.astro";
import ThumbnailElement from "./ThumbnailElement.astro";

interface Props {
    totalImages: number;
  };
  
  const { totalImages } = Astro.props;

---

<div class:list={["fade", "GalleryElementWrapper"]}>
	<div id="ImageWrapper">

		<div id="ImageContainer">
			<slot name="Image1" />
		</div>

		<div id="ImageContainer">
			<slot name="Image2" />
		</div>
		
		<div id="ImageContainer">
			<slot name="Image3" />
		</div>

		<div id="ImageContainer">
			<slot name="Image4" />

		</div>

		<div id="ImageContainer">
			<slot name="Image5" />
		</div>
	</div>
	<div id="ThumbnailWrapper">
		<SquareBracketH padding="0.25rem 1rem">
			<div id="TextContainer">
				<h1>Game Design 101</h1>
				<h2>Poster</h2>
			</div>
		</SquareBracketH>
		<SquareBracketH>
			<div id="ArrowWrapper">
				<div id="ArrowContainer">
					&larr;
				</div>
				<div id="CounterContainer">
					1 / {totalImages}
				</div>
		
				<div id="ArrowContainer">
					&rarr;
				</div>

			</div>
		
			
<!-- 			<div id="GalleryThumbnails">
				<div id="Thumbnail">
					<slot name="ThumbnailImage2" />
				</div>

				<div id="Thumbnail">
					<slot name="ThumbnailImage3" />
				</div>

				<div id="Thumbnail">
					<slot name="ThumbnailImage4" />
				</div>

				<div id="Thumbnail">
					<slot name="ThumbnailImage5" />
				</div>
			</div> -->
		</SquareBracketH>
	</div>

<script define:vars={{ totalImages }}>

/* Gallery Thumbnails Hover Interaction 
document.querySelectorAll('#GalleryThumbnails #Thumbnail').forEach(function(thumbnail, index) {
    thumbnail.addEventListener('mouseover', function() {
        document.querySelector(`#ImageWrapper #ImageContainer:nth-child(${index + 2})`).style.opacity = '1';
    });

    thumbnail.addEventListener('mouseout', function() {
        document.querySelector(`#ImageWrapper #ImageContainer:nth-child(${index + 2})`).style.opacity = '0';
    });
});
*/

let currentIndex = 1; // Start at the first image


// Function to update image visibility based on the current index
function updateImageVisibility() {
  document.querySelectorAll('#ImageWrapper #ImageContainer').forEach((div, index) => {
    if (index + 1 === currentIndex) {
      div.style.opacity = '1';  // Show the current image
    } else {
      div.style.opacity = '0';  // Hide other images
    }
  });
}

function updateCounter() {
  const counterContainer = document.querySelector('#CounterContainer');
  counterContainer.textContent = `${currentIndex} / ${totalImages}`;
}

// Right arrow click event to increase the index
document.querySelector('#ArrowWrapper  div:nth-child(3)').addEventListener('click', function() {
  currentIndex++;
  if (currentIndex > totalImages) {
    currentIndex = 1; // Loop back to the first image
  }
  updateImageVisibility();
  updateCounter();
});

// Left arrow click event to decrease the index
document.querySelector('#ArrowWrapper  div:nth-child(1)').addEventListener('click', function() {
  currentIndex--;
  if (currentIndex < 1) {
    currentIndex = totalImages; // Loop back to the last image
  }
  updateImageVisibility();
  updateCounter();
});

// Initialize the gallery with the first image visible
updateImageVisibility();
updateCounter();

</script>

<style>

@import "../styles/global.css";

.GalleryElementWrapper {
	display: grid;
}

/* Images Overlapping*/
#ImageWrapper {
	display: grid; /* Parent container needs to be relative */
	grid-template-columns: 1fr;
	grid-template-rows: 1fr;
	pointer-events: auto;

}

#ImageWrapper > div {
	grid-column: 1;
	grid-row: 1;
	transition: opacity 0.3s ease;
}

#ImageWrapper > div:nth-of-type(1) {
  opacity: 1; /* First image should be visible */
}

#ImageWrapper > div:nth-of-type(2) {
opacity: 0;
}

#ImageWrapper > div:nth-of-type(3) {
opacity: 0;
}

#ImageWrapper > div:nth-of-type(4) {
opacity: 0;
}

#ImageWrapper > div:nth-of-type(5) {
opacity: 0;
}



/* Thumbnails */ 

#ThumbnailWrapper {
	display: grid; 
	width: 100%;
	grid-template-columns: 3fr 2fr;
	justify-content: center;

}




/* Thumbnail Elements */

#GalleryThumbnails {
	display: grid;
	grid-template-columns: repeat(4, 1fr);
	grid-auto-rows: auto;
	gap: 5%;
	filter: sepia(0.5) grayscale(0.5);
	justify-content: center;
	opacity: 0.75;
}

#Thumbnail {
	pointer-events: auto;
}

/* Arrows */

#ArrowWrapper {
	display: grid;
	grid-template-columns: 1fr 2fr 1fr; 
}

#ArrowContainer {
	text-align: center;
	pointer-events: auto;
	cursor: pointer;

}

#CounterContainer {
	text-align: center;
	font-size: 0.8rem;
}

/* Thumbnail Text */
#TextContainer {
	padding-left: 0.7rem;

	@media (--bp-mobile) {
		padding: 0.5rem;
	}
}

h1 {
	font-family: PowerGrotesk-Medium;
	font-weight: 600;
	font-style: normal;
	font-size: 0.8rem;
	letter-spacing: 0.7px;
	margin: 0px;

	@media (--bp-mobile) {
		font-size: 0.8rem;
	}

	@media (--bp-tablet) {
		font-size: 0.8rem;
	}

}

h2 {
	font-family: PowerGrotesk-Light;
	font-weight: 200;
	font-style: italic;
	font-size: 0.6rem;
	letter-spacing: 0.5px;
	margin: 0px;
	margin-top: 4px;
	

	@media (--bp-mobile) {
		font-size: 0.6rem;
		margin-top: 0px;
	}

	@media (--bp-tablet) {
		font-size: 0.6rem;
		margin-top: 0px;
	}

}

h3 {
	font-family: PowerGrotesk-Light;
	font-weight: 200;
	font-style: normal;
	font-size: 0.8rem;
	text-align: end;
	letter-spacing: 0.5px;
	margin: 0px;


	@media (--bp-mobile) {
		font-size: 0.6rem;
	}

	@media (--bp-tablet) {
		font-size: 0.6rem;
	}

}
</style>